(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4144],{5087:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/workspace/[workspaceId]",function(){return t(83964)}])},67572:function(e,n,t){"use strict";var r=t(52322),i=t(57821),o=t(96933),u=t(71059);n.Z=function(e){var n=e.hideSplashOnLoad,t=void 0===n||n,a=e.children,s=(0,o.fC)();return((0,u.Z)(function(){s&&t&&(0,i.hf)(!0)},[s,t]),s)?/*#__PURE__*/(0,r.jsx)(r.Fragment,{children:a}):null}},33816:function(e,n,t){"use strict";var r=t(25237),i=/*#__PURE__*/t.n(r),o=t(69803);window.hljs=o.ZP,n.Z=i()(function(){return Promise.all([t.e(3488),t.e(4526),t.e(8037),t.e(8483),t.e(791),t.e(9534),t.e(9005),t.e(8849),t.e(1498),t.e(9523),t.e(2960),t.e(6946),t.e(8477),t.e(7276),t.e(7309),t.e(3657),t.e(1762),t.e(3815),t.e(2439),t.e(569),t.e(2262),t.e(4656),t.e(6859),t.e(3981),t.e(9685),t.e(4204),t.e(3389),t.e(4432),t.e(6229),t.e(8045),t.e(4583),t.e(3878)]).then(t.bind(t,51163))},{loadableGenerated:{webpack:function(){return[51163]}},ssr:!1})},89551:function(e,n,t){"use strict";t.d(n,{O:function(){return d}});var r=t(70865),i=t(96670),o=t(26297),u=t(2784),a=t(2595),s=t(39183),c=t(76592),l=t(89960);function d(){var e=(0,a.Z)(),n=(0,s.mT)();return{onError:(0,u.useCallback)(function(t){var u=(0,c.E)(t,"Unknown",{}),a=u.error,s=(0,o.Z)(u,["error"]);!1!==a.isSevere&&e.error(a.message,{id:a.message}),a.handled||(0,l.Tb)(a,(0,i.Z)((0,r.Z)({},s),{workspaceId:n}))},[n])}}},5566:function(e,n,t){"use strict";var r=t(2784),i=t(20578);n.Z=function(){(0,r.useEffect)(function(){return i.Z.init(),function(){return i.Z.dispose()}},[])}},96286:function(e,n,t){"use strict";var r=t(52322),i=/*#__PURE__*/(0,t(2784).memo)(function(){return/*#__PURE__*/(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n      body {\n        overflow: hidden;\n      }\n    "}})});i.displayName="WorkspaceBodyStyles",n.Z=i},10461:function(e,n,t){"use strict";var r=t(52322),i=t(58410),o=t(57821),u=t(39183),a=t(71059);n.Z=function(e){var n=e.hideSplashOnLoad,t=void 0===n||n,s=e.isEmbedIntegration,c=void 0!==s&&s,l=e.children,d=(0,u.Rx)(),f=(0,u.vP)(),v=(0,u.sx)();return((0,a.Z)(function(){d&&t&&(0,o.hf)()},[d,t]),d)?(null==v?void 0:v.hasAccess)?f?/*#__PURE__*/(0,r.jsx)(r.Fragment,{children:l}):/*#__PURE__*/(0,r.jsx)(i.Z,{statusCode:404,hideActionButtons:c}):/*#__PURE__*/(0,r.jsx)(i.Z,{statusCode:403,hideActionButtons:c}):null}},19377:function(e,n,t){"use strict";var r=t(52322),i=t(97729),o=/*#__PURE__*/t.n(i),u=t(39183);n.Z=function(){var e=(0,u.u0)();return e?/*#__PURE__*/(0,r.jsx)(o(),{children:/*#__PURE__*/(0,r.jsxs)("title",{children:[e," â€” Eraser"]})}):null}},13410:function(e,n,t){"use strict";var r=t(25237),i=/*#__PURE__*/t.n(r);n.Z=i()(function(){return t.e(1941).then(t.bind(t,71941))},{loadableGenerated:{webpack:function(){return[71941]}},ssr:!1})},99811:function(e,n,t){"use strict";t.d(n,{fu:function(){return f},oQ:function(){return d}});var r=t(70865),i=t(96670),o=t(52322),u=t(2784),a=t(96933),s=t(39183),c=t(4406),l=t(45403),d=function(e){var n=Date.now(),t=[];return e.forEach(function(e){var r=e.id,i=e.heartbeat;n-(void 0===i?n:i)<=15e3&&t.push(r)}),t},f=function(e,n){var t=(0,l.fz)(function(e){return e.workspaceCollaborators},e);return(0,u.useMemo)(function(){var e=d(null!=t?t:[]);return n?e.filter(function(e){return e!==n}):e},[t,n])};n.ZP=function(e){var n=(0,a.II)(),t=(0,u.useState)([]),l=t[0],d=t[1],v=f((0,s.mT)()||"");return(0,u.useEffect)(function(){v&&d(v.filter(function(e){return e!==n}))},[n,v]),/*#__PURE__*/(0,o.jsx)(c.Z,(0,i.Z)((0,r.Z)({},e),{horizontalAlign:"end",max:3,userIds:l}))}},74726:function(e,n,t){"use strict";t.d(n,{P:function(){return d},X:function(){return l}});var r=t(52322),i=t(2784),o=t(64323),u=t(98916),a=t(96933),s=t(45403),c=t(56060),l=/*#__PURE__*/(0,i.createContext)({dismiss:function(){},wasDismissed:function(){return!1}}),d=function(e){var n,t=e.tutorialId,d=e.children,f=(0,i.useState)([]),v=f[0],p=f[1],h=(0,u.b)().activations,m=(0,a.aF)(),I=(0,s.Pe)();(0,i.useEffect)(function(){var e;p((null==m?void 0:null===(e=m.userSettings)||void 0===e?void 0:e.dismissedHints)||[])},[null==m?void 0:null===(n=m.userSettings)||void 0===n?void 0:n.dismissedHints]);var _=(0,i.useCallback)(function(e){return v.includes(e)},[v]),g=(0,i.useCallback)(function(e){if(!(!m||!e||_(e))){var n=v.concat(e);p(n),I.currentUser.updateCurrentUser({userSettings:{dismissedHints:n}})}},[m,v,_]);return(0,i.useEffect)(function(){h[c.c.AddFigure]&&g(o.X.ORGANIZE_WITH_FIGURES),h[c.c.AddFigureEmbed]&&g(o.X.EMBED_FIGURE_IN_DOCUMENT),h[c.c.AddComment]&&g(o.X.LEAVE_COMMENT)},[h,g]),/*#__PURE__*/(0,r.jsx)(l.Provider,{value:{activeTutorialId:t,dismiss:g,wasDismissed:_},children:d})}},93322:function(e,n,t){"use strict";t.d(n,{Sh:function(){return k},ZP:function(){return A}});var r,i=t(70865),o=t(96670),u=t(52322),a=t(2784),s=t(18149),c=/*#__PURE__*/t.n(s),l=t(5632),d=t(20578),f=t(57685),v=t(39183),p=t(355),h=t(75194),m=t(27196),I=t(61534),_=t(99669),g="layout-sizes",E=[1,1],w=I.X.Document,Z=function(){var e,n,t,i,o,u=(0,f.K)(),s=(0,h.d)(),Z=(0,l.useRouter)().route,b=(0,a.useState)(0),k=b[0],A=b[1],C=(0,a.useState)((e=Z.endsWith("/embed"),n=u.layout,t=u.element,i=u.elements,o=(0,v.ZP)(),"string"==typeof n&&(0,p.$)(n)?n:t||i?I.X.Canvas:(null==o?void 0:o.hasFigureEmbed)?I.X.Document:(null==o?void 0:o.hasDrawing)===(null==o?void 0:o.hasNotes)?e?I.X.Canvas:s?w:I.X.Both:(null==o?void 0:o.hasDrawing)?I.X.Canvas:I.X.Document)),T=C[0],S=C[1],x=(0,a.useState)((r||(r=_.J.getItem(g)||E),r)),R=x[0],U=x[1],y=(0,m.D9)(R),M=(0,m.D9)(T);(0,a.useEffect)(function(){null==T||c()(T,M)||_.J.setItem("layout-mode",T)},[T,M]),(0,a.useEffect)(function(){null==R||c()(R,y)||_.J.setItem(g,R)},[R,y]),(0,a.useEffect)(function(){s&&T===I.X.Both&&S(w)},[s,T]);var N=(0,a.useMemo)(function(){return function(e){switch(e){case I.X.Canvas:return[!1,!0];case I.X.Document:return[!0,!1];default:return[!0,!0]}}(T)},[T]);return(0,a.useEffect)(function(){d.Z.emit("layout-ready",S)},[]),{sizes:R,visibilities:N,setSizes:U,setLayout:S,offsetTop:k,setOffsetTop:A,layout:T}},b=/*#__PURE__*/(0,a.createContext)(void 0),k=function(e){var n=e.children,t=Z(),r=(0,a.useState)(!1),s=r[0],c=r[1],l=(0,a.useState)(!1),d=l[0],f=l[1],v=(0,a.useState)(!1),p=v[0],h=v[1],m=(0,a.useState)(!0),I=m[0],_=m[1],g=(0,a.useState)(!0),E=g[0],w=g[1],k=(0,a.useCallback)(function(){c(function(e){return!e})},[]);return/*#__PURE__*/(0,u.jsx)(b.Provider,{value:(0,o.Z)((0,i.Z)({},t),{isNotepadReady:d,isWhiteboardReady:p,isWhiteboardEmpty:I,isNotepadEmpty:E,isUiHidden:s,toggleUi:k,setNotepadReady:f,setWhiteboardReady:h,setWhiteboardEmpty:_,setNotepadEmpty:w}),children:n})},A=b},34184:function(e,n,t){"use strict";t.d(n,{X:function(){return k}});var r=t(70865),i=t(96670),o=t(87394),u=t(52322),a=t(2784),s=t(5632),c=t(69071),l=t(37164),d=t(2595),f=t(51716),v=t(28378),p=t(89551),h=t(45403),m=t(11269),I=t(96933),_=t(57347),g=t(71059),E=t(89960),w=t(38947),Z=function(e,n,t){var r=(0,h.Pe)(),i=(0,a.useState)(),o=i[0],u=i[1],s=void 0!==n,c=null==n?void 0:n.id,l=null==n?void 0:n.teamId;return(0,a.useEffect)(function(){if(!s||!e||!c||!l){u(!1);return}r.workspaceMembers.isWorkspaceMember(c,e).then(u)},[c,l,e,s]),(0,a.useMemo)(function(){if(void 0!==o&&null!=t)return{isMember:o,hasAccess:t.read,isReadOnly:t.read&&!t.write}},[o,t])},b=function(e){var n=e.teamId,t=e.workspaceId,r=(0,h.Pe)(),i=(0,c.f)(r.workspaces.getWorkspaceTeamInfo),o=i.execute,u=i.loading,s=i.result;return(0,a.useEffect)(function(){n&&t&&o(n,t)},[n,t,o]),{loading:u,teamInfo:s}},k=function(e){var n,t,k,A,C,T,S,x,R,U,y,M,N,O,j,P,D,X,F,G,B=e.workspaceId,L=e.environment,W=void 0===L?"default":L,J=e.externalUserId,H=e.children,z=(0,s.useRouter)(),K=(0,h.Pe)(),q=(0,m.mZ)(),V=(0,m.LP)(),Q=(0,o.Z)((0,m.p3)(),2)[1],Y=(0,a.useState)({environment:W}),$=Y[0],ee=Y[1],en=(0,I.II)(),et=J||en,er=(0,I.g5)(),ei=(0,a.useState)(void 0),eo=ei[0],eu=ei[1];(0,a.useEffect)(function(){ee({environment:W}),ef.current=!1},[W,B]),(0,a.useEffect)(function(){if(eu(void 0),B)return K.workspaces.subscribeById(B,function(e,n){if(n){eu(null);return}eu(e)})},[B]);var ea=b({workspaceId:B,teamId:null==eo?void 0:eo.teamId}).teamInfo,es=(n=(0,h.Pe)(),k=(t=(0,a.useState)({result:null,loading:!0,error:null}))[0],A=t[1],(C=(0,a.useRef)(k)).current=k,T=(0,I.II)(),S=(0,a.useCallback)(function(e,t,r){e&&t&&(C.current.loading=!0,A(function(e){return{result:r?null:e.result,loading:!0,error:null}}),n.workspaces.validateAccess(t).then(function(e){A({result:e,loading:!1})}).catch(function(e){A({error:e,loading:!1,result:null})}))},[]),(0,a.useEffect)(function(){S(T,B,!0)},[T,B,S]),(0,a.useEffect)(function(){if(B&&T){var e=_.database.ref("workspaces/".concat(B,"/userAccess/").concat(T)),n=_.database.ref("workspaces/".concat(B,"/publicAccess")),t=function(e){var n,t,r=null==e?void 0:e.val(),i=C.current;!r&&!i.loading&&((null===(n=C.current.result)||void 0===n?void 0:n.read)||(null===(t=C.current.result)||void 0===t?void 0:t.write))&&S(T,B,!1)};return e.on("value",t),n.on("value",t),function(){e.off("value",t),n.on("value",t)}}},[S,B,T]),k),ec=es.result,el=es.error,ed=Z(et,eo,ec);(0,a.useEffect)(function(){ee(function(e){return(0,i.Z)((0,r.Z)({},e),{access:ed,teamInfo:ea,showTeamJoinBanner:!!(null==ea?void 0:ea.canJoinTeam)})})},[ed,ea]);var ef=(0,a.useRef)(!1),ev=(0,c.Z)(K.workspaces.markWorkspaceAsVisited),ep=z.pathname.includes("/image");(0,a.useEffect)(function(){if(!ef.current&&eo&&et&&!er&&!ep){var e=eo.id;ev.execute(e).catch(E.Tb),ef.current=!0}},[et,eo,ev,er,ep]),(0,g.Z)(function(){eo&&V&&eo.teamId&&eo.teamId!==V&&q.has(eo.teamId)&&Q(eo.teamId)},[eo,V,q,Q]);var eh=(R=(x={userId:et,workspaceId:B}).workspaceId,U=x.userId,y=(0,h.Pe)(),M=(0,d.Z)(),N=(0,f.Z)(),j=(O=(0,a.useState)(0))[0],P=O[1],D=(0,a.useCallback)(function(){return P(function(e){return e+1})},[]),X=(0,p.O)().onError,G=null==(F=(0,a.useMemo)(function(){if(U&&R){var e=(0,l.x0)(),n=y.makeNotesAccessor({workspaceId:R,userId:U,clientId:e});return new v.W({userId:U,clientId:e,adapter:n,onError:X,onConnectionChange:function(e){e&&M.success("Connection to server re-established.",{id:"connection"}),N()}})}},[R,U,N,j]))?void 0:F.isReady,(0,a.useEffect)(function(){if(!G){null==F||F.getInitialData().then(N);return}if(G)return function(){null==F||F.destroy()}},[F,G,N]),{collab:G?F:void 0,restartCollab:D}),em=eh.collab,eI=eh.restartCollab,e_=(0,a.useCallback)(function(){ee(function(e){return(0,i.Z)((0,r.Z)({},e),{showTeamJoinBanner:!1})})},[]),eg=(0,a.useMemo)(function(){return(0,i.Z)((0,r.Z)({},$),{workspace:eo,slateCollab:em,restartSlateCollab:eI,hideTeamJoinBanner:e_})},[$,em,eI,eo,e_]);return ec||el?/*#__PURE__*/(0,u.jsx)(w.e.Provider,{value:eg,children:H}):null}},32489:function(e,n,t){"use strict";t.d(n,{s:function(){return i}});var r=t(57685),i=function(){return"true"===(0,r.K)().embed}},34809:function(e,n,t){"use strict";var r=t(2784),i=t(93322);n.Z=function(){return(0,r.useContext)(i.ZP)}},83964:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSP:function(){return W},createWorkspaceOg:function(){return J},default:function(){return H}});var r=t(52322),i=t(2784),o=t(5632),u=/*#__PURE__*/t.n(o),a=t(67572),s=t(58410),c=t(66140),l=t(99811),d=t(23630),f=t(32489),v=t(25487),p=t(34809),h=t(10847),m=t(96933),I=t(2332),_=t(39183),g=t(42541),E=t(6021),w=t(20417),Z=t(95162),b=t(88404),k=t(75194),A=t(59711),C=t(35773),T=/*#__PURE__*/t.n(C),S=function(e){var n=e.ownerId,t=(0,I.ZP)(null!=n?n:"");return t?/*#__PURE__*/(0,r.jsxs)("p",{children:["Create a free account to collaborate with ",t.displayName,". By signing up, you agree to our ",/*#__PURE__*/(0,r.jsx)("a",{href:"".concat(c.CF.url,"/terms"),children:"terms of service"})]}):null};function x(){var e=new URLSearchParams(window.location.search);return e.set(d.eX,"true"),"".concat(window.location.pathname,"?").concat(e.toString())}var R=function(){var e,n,t=(0,f.s)(),o=(0,k.d)(),a=(0,m.fC)(),s=(0,m.TF)(a),c=(0,h.E)("skip_file_auth_team_ids").value,d=(0,_.bm)(),I=d.teamInfo,C=d.workspace,R="integration"===d.environment,U=(0,l.fu)((null===(e=d.workspace)||void 0===e?void 0:e.id)||"",null==a?void 0:a.id),y=(0,p.Z)().setOffsetTop,M=(0,i.useState)(s&&!t&&!o),N=M[0],O=M[1],j=(0,v.Z)(),P=(null==I?void 0:I.id)&&((void 0===c?[]:c).includes(I.id)||(null==C?void 0:C.isAnonymousAccessAllowed)||(null==C?void 0:C.directAccessMode)===A.lL.Read),D=I&&!P&&!R&&N;(0,i.useEffect)(function(){y(N?40:0)},[N,y]),(0,i.useEffect)(function(){if(D&&s){var e;g.Z.trackEvent(null,"page_view",{page_title:"Sign Up",page_location:"".concat(document.location.origin,"/auth/sign-up"),page_path:"/auth/sign-up",embedded_at_path:u().asPath}),j.openSignUpModal({isClosable:!1,customSubTitle:/*#__PURE__*/(0,r.jsx)(S,{ownerId:null===(e=d.workspace)||void 0===e?void 0:e.ownerId}),profileArgs:{signUpOrigin:"workspace"},onSignIn:function(e){u().replace(x()),O(!1),j.closeAuthModal(),(null==I?void 0:I.isAutoJoinEnabled)&&(null==e?void 0:e.userId)&&e.isNewUser&&(0,E.Z)(I.id,null==e?void 0:e.userId,{isAutoJoin:!0,origin:"workspace"}).catch(function(){})}})}},[D,j.openSignUpModal,j.closeAuthModal,s,I,null===(n=d.workspace)||void 0===n?void 0:n.ownerId]);var X=(0,i.useCallback)(function(){g.Z.trackEvent("auth_banner","sign_up_click",{teamId:null==I?void 0:I.id,teamDomain:null==I?void 0:I.domain,teamAutoJoinEnabled:null==I?void 0:I.isAutoJoinEnabled,activeCollaborarCount:U.length}),g.Z.trackEvent(null,"page_view",{page_title:"Sign Up",page_location:"".concat(document.location.origin,"/auth/sign-up"),page_path:"/auth/sign-up",embedded_at_path:u().asPath}),j.openSignUpModal({isClosable:!0,profileArgs:{signUpOrigin:R?"integration":"workspace"},onSignIn:function(){u().replace(x()),O(!1)}})},[I,j.openSignUpModal,U,R]);return!N||D?null:/*#__PURE__*/(0,r.jsx)("div",{className:T().header,children:/*#__PURE__*/(0,r.jsxs)("div",{className:T().wrapper,"data-testid":"auth-banner",children:[/*#__PURE__*/(0,r.jsx)("div",{className:T().text,children:"Create multiple files and share everything with your team."}),/*#__PURE__*/(0,r.jsx)(Z.ZP,{className:T().signIn,onClick:X,children:"Sign Up Free"}),/*#__PURE__*/(0,r.jsx)("div",{className:T().close,children:/*#__PURE__*/(0,r.jsx)(b.J,{icon:w.Z,onClick:function(){return O(!1)}})})]})})},U=t(33816),y=t(5566),M=t(96286),N=t(10461),O=t(19377),j=t(13410),P=t(93322),D=t(34184),X=t(11269),F=t(57685),G=t(2600),B=function(e){var n=e.workspaceId,t=(0,F.K)(),r=(0,X.LP)(),o=(0,i.useState)(!1),u=o[0],a=o[1],s=(0,G.X)().request;return(0,i.useEffect)(function(){"duplicate"===t.action&&n&&"string"==typeof n&&r&&!u&&(a(!0),s({workspaceId:n,teamId:r},{reload:!0}))},[r,s,u,t.action,n]),null},L=t(74726),W=!0,J=function(e,n,t){e=e||"Untitled File";var r=t.split("?");return t="".concat(r[0],"/preview").concat(2===r.length?"?":"").concat(r[1]||""),{title:e,description:n||"Create diagrams, wireframes, technical specs with your team. Your all-in-one technical ideation tool.",images:[{url:"".concat(c.l2.url).concat(t),width:1200,height:630,alt:e}]}},H=function(){var e=(0,o.useRouter)(),n=e.query.workspaceId;return((0,y.Z)(),B({workspaceId:n}),e.isReady)?"string"!=typeof n?/*#__PURE__*/(0,r.jsx)(s.Z,{statusCode:404,title:"File not found"}):/*#__PURE__*/(0,r.jsxs)("div",{className:"workspace",children:[/*#__PURE__*/(0,r.jsx)(a.Z,{hideSplashOnLoad:!1,children:/*#__PURE__*/(0,r.jsx)(D.X,{workspaceId:n,children:/*#__PURE__*/(0,r.jsx)(L.P,{children:/*#__PURE__*/(0,r.jsxs)(N.Z,{children:[/*#__PURE__*/(0,r.jsx)(O.Z,{}),/*#__PURE__*/(0,r.jsx)(j.Z,{}),/*#__PURE__*/(0,r.jsxs)(P.Sh,{children:[/*#__PURE__*/(0,r.jsx)(R,{}),/*#__PURE__*/(0,r.jsx)(U.Z,{})]})]})})})}),/*#__PURE__*/(0,r.jsx)(M.Z,{})]}):null}},64323:function(e,n,t){"use strict";var r,i;t.d(n,{X:function(){return r}}),(i=r||(r={})).DIAGRAM_GPT_TOUR="DIAGRAM_GPT_TOUR",i.PRODUCT_TOUR="PRODUCT_TOUR",i.INSERT_MENU_TUTORIAL="INSERT_MENU_TUTORIAL",i.MAKE_A_FIGURE_TUTORIAL="MAKE_A_FIGURE_TUTORIAL",i.DIAGRAM_WITH_CODE_TUTORIAL="DIAGRAM_WITH_CODE_TUTORIAL",i.EMBED_FIGURE_IN_DOCUMENT="EMBED_FIGURE_IN_DOCUMENT",i.LEAVE_COMMENT="LEAVE_COMMENT",i.ORGANIZE_WITH_FIGURES="ORGANIZE_WITH_FIGURES"},35773:function(e){e.exports={header:"AuthBanner_header__hgvMD",wrapper:"AuthBanner_wrapper__Cznaq",text:"AuthBanner_text__SBtet",signIn:"AuthBanner_signIn__ugcMl",close:"AuthBanner_close__FmqGy"}}},function(e){e.O(0,[2888],function(){return e(e.s=5087)}),_N_E=e.O()}]);